<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Roteiro de Viagem Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f9ff;
        }
        #map {
            height: 400px;
            width: 100%;
            border-radius: 1rem;
        }
        @media (max-width: 768px) {
            #map {
                height: 300px;
            }
        }
        .place-item {
            transition: all 0.3s ease;
        }
        .place-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .category-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .toast {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            background-color: #0ea5e9;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        .toast.error {
            background-color: #dc2626;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .gm-style .gm-style-iw-c {
            padding: 0 !important;
            border-radius: 0.5rem !important;
        }
        .gm-style .gm-style-iw-d {
            overflow: hidden !important;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Cabeçalho -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-blue-800">Roteiro de Viagem</h1>
            <nav class="flex gap-4">
                <button id="export-btn" class="text-blue-600 font-medium hover:text-blue-800">Exportar</button>
                <button id="help-btn" class="text-gray-500 hover:text-gray-700">Ajuda</button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6 max-w-4xl">
        <!-- Seção do Mapa -->
        <section class="card bg-white p-4 mb-6 shadow-md rounded-xl">
            <div class="flex justify-between items-center mb-3">
                <h2 class="text-lg font-semibold text-blue-800">Mapa da Viagem</h2>
                <div class="flex items-center space-x-2">
                    <span id="gps-status" class="text-xs bg-gray-100 px-2 py-1 rounded-full hidden">
                        <span class="inline-block w-2 h-2 rounded-full bg-gray-400 mr-1"></span>
                        GPS Desconectado
                    </span>
                </div>
            </div>
            <div id="map" class="mb-3"></div>
            <div class="flex flex-wrap justify-between gap-2">
                <div class="flex space-x-2">
                    <button id="start-trip" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                        </svg>
                        Iniciar Viagem
                    </button>
                    <button id="optimize-route" class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg font-medium hover:bg-blue-200 transition flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                        </svg>
                        Otimizar Rota
                    </button>
                </div>
                <button id="clear-route" class="text-red-600 hover:text-red-800 px-4 py-2 rounded-lg border border-red-200 hover:bg-red-50 transition flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                    Limpar Tudo
                </button>
            </div>
        </section>

        <!-- Seção de Configurações -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <!-- Configurações do Veículo -->
            <div class="card bg-white p-5 shadow-md rounded-xl">
                <h2 class="text-lg font-semibold text-blue-800 mb-4">Configurações do Veículo</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Consumo (km/l)</label>
                        <input id="fuel-efficiency" type="number" min="1" value="10" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300 focus:border-blue-300">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Preço do Combustível (R$/l)</label>
                        <input id="fuel-price" type="number" min="0.1" step="0.01" value="5.50" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300 focus:border-blue-300">
                    </div>
                </div>
            </div>

            <!-- Adicionar Local -->
            <div class="card bg-white p-5 shadow-md rounded-xl">
                <h2 class="text-lg font-semibold text-blue-800 mb-4">Adicionar Local</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Pesquisar local...</label>
                        <div class="relative">
                            <input id="search" type="text" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300 focus:border-blue-300" placeholder="Digite o nome de um local">
                            <button id="btn-search" class="absolute right-2 top-2 bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nome do Local</label>
                            <input id="place-name" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Custo (R$)</label>
                            <input id="place-value" type="number" min="0" step="0.01" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                        <select id="place-category" class="w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-300">
                            <option value="attraction">Atração Turística</option>
                            <option value="park">Parque/Natureza</option>
                            <option value="hotel">Hotel/Hospedagem</option>
                            <option value="restaurant">Restaurante</option>
                            <option value="museum">Museu/Cultural</option>
                            <option value="shopping">Compras</option>
                            <option value="other">Outro</option>
                        </select>
                    </div>
                    
                    <button id="add-place" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium transition flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                        </svg>
                        Adicionar Local
                    </button>
                </div>
            </div>
        </section>

        <!-- Seção de Conteúdo -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Locais Salvos -->
            <div class="card bg-white p-5 shadow-md rounded-xl lg:col-span-2">
                <h2 class="text-lg font-semibold text-blue-800 mb-4">Locais Salvos</h2>
                <div id="places-list" class="space-y-3">
                    <div class="text-center py-8 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <p>Nenhum local adicionado ainda</p>
                        <p class="text-sm mt-1">Adicione locais para começar seu roteiro</p>
                    </div>
                </div>
            </div>

            <!-- Gastos Gerais -->
            <div class="card bg-white p-5 shadow-md rounded-xl">
                <h2 class="text-lg font-semibold text-blue-800 mb-4">Gastos Gerais</h2>
                <div id="expenses-list" class="space-y-3 mb-4">
                    <div class="text-center py-8 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p>Nenhum gasto adicionado</p>
                        <p class="text-sm mt-1">Registre seus gastos durante a viagem</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                        <input id="expense-title" class="w-full p-3 border border-gray-200 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                        <input id="expense-amount" type="number" min="0" step="0.01" class="w-full p-3 border border-gray-200 rounded-lg">
                    </div>
                    <div class="md:col-span-3">
                        <button id="add-expense" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium transition">
                            Adicionar Gasto
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Resumo da Viagem -->
        <section class="card bg-white p-5 shadow-md rounded-xl">
            <h2 class="text-lg font-semibold text-blue-800 mb-4">Resumo da Viagem</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">Distância Total</p>
                    <p id="total-distance" class="text-xl font-bold text-blue-700">0 km</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">Tempo Total</p>
                    <p id="total-time" class="text-xl font-bold text-blue-700">0 min</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">Custo de Combustível</p>
                    <p id="fuel-cost" class="text-xl font-bold text-blue-700">R$ 0,00</p>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">Custo dos Locais</p>
                    <p id="places-cost" class="text-xl font-bold text-blue-700">R$ 0,00</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-600">Gastos Gerais</p>
                    <p id="expenses-cost" class="text-xl font-bold text-blue-700">R$ 0,00</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border-2 border-blue-200">
                    <p class="text-sm text-gray-600">Custo Total Estimado</p>
                    <p id="total-cost" class="text-2xl font-bold text-blue-800">R$ 0,00</p>
                </div>
            </div>

            <div id="route-details" class="space-y-2">
                <!-- Detalhes da rota serão inseridos aqui -->
            </div>
        </section>
    </main>

    <!-- Modal de Ajuda -->
    <div id="help-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-blue-800">Ajuda - Roteiro de Viagem</h3>
                <button id="close-help" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="space-y-4 text-sm text-gray-700">
                <div>
                    <h4 class="font-semibold text-blue-700">Como adicionar locais:</h4>
                    <p>1. Pesquise pelo local no campo "Pesquisar local"</p>
                    <p>2. Preencha os detalhes (nome, custo, categoria)</p>
                    <p>3. Clique em "Adicionar Local"</p>
                </div>
                <div>
                    <h4 class="font-semibold text-blue-700">Rastreamento GPS:</h4>
                    <p>• Clique em "Iniciar Viagem" para começar a registrar seu trajeto</p>
                    <p>• Sua posição será mostrada no mapa em tempo real</p>
                    <p>• O trajeto percorrido será desenhado no mapa</p>
                </div>
                <div>
                    <h4 class="font-semibold text-blue-700">Otimização de Rota:</h4>
                    <p>• Adicione pelo menos 2 locais</p>
                    <p>• Clique em "Otimizar Rota" para calcular o melhor caminho</p>
                </div>
                <div>
                    <h4 class="font-semibold text-blue-700">Dicas:</h4>
                    <p>• Atualize as configurações do veículo para cálculos precisos</p>
                    <p>• Registre todos os gastos para ter um controle financeiro</p>
                    <p>• Exporte seu roteiro para compartilhar ou salvar</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let map;
        let directionsService;
        let directionsRenderer;
        let markers = [];
        let places = [];
        let generalExpenses = [];
        let infoWindow;
        
        // Variáveis para o rastreamento GPS
        let watchId = null;
        let currentPositionMarker = null;
        let pathCoordinates = [];
        let pathPolyline = null;
        let isTracking = false;

        // Cores e ícones para categorias
        const categoryStyles = {
            attraction: { color: 'red', icon: 'https://maps.google.com/mapfiles/ms/icons/red-dot.png', name: 'Atração' },
            park: { color: 'green', icon: 'https://maps.google.com/mapfiles/ms/icons/green-dot.png', name: 'Parque' },
            hotel: { color: 'blue', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', name: 'Hotel' },
            restaurant: { color: 'orange', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', name: 'Restaurante' },
            museum: { color: 'yellow', icon: 'https://maps.google.com/mapfiles/ms/icons/yellow-dot.png', name: 'Museu' },
            shopping: { color: 'pink', icon: 'https://maps.google.com/mapfiles/ms/icons/pink-dot.png', name: 'Compras' },
            other: { color: 'purple', icon: 'https://maps.google.com/mapfiles/ms/icons/purple-dot.png', name: 'Outro' }
        };

        // Estilo para o marcador de posição atual
        const currentPositionIcon = {
            url: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png',
            scaledSize: new google.maps.Size(40, 40),
            anchor: new google.maps.Point(20, 20)
        };

        // Função para mostrar notificações
        function showToast(message, isError = false) {
            const toast = document.createElement('div');
            toast.className = `toast ${isError ? 'error' : ''}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Inicialização do mapa
        function initMap() {
            // Configuração inicial do mapa
            const initialLocation = { lat: -15.795, lng: -47.891 };
            
            map = new google.maps.Map(document.getElementById('map'), {
                center: initialLocation,
                zoom: 4,
                styles: [
                    {
                        featureType: "poi",
                        elementType: "labels",
                        stylers: [{ visibility: "off" }]
                    },
                    {
                        featureType: "transit",
                        elementType: "labels.icon",
                        stylers: [{ visibility: "off" }]
                    }
                ],
                gestureHandling: "greedy",
                disableDefaultUI: true,
                zoomControl: true,
                fullscreenControl: true
            });

            // Serviços do Google Maps
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer({
                map: map,
                suppressMarkers: true,
                polylineOptions: {
                    strokeColor: '#0ea5e9',
                    strokeOpacity: 0.8,
                    strokeWeight: 5
                }
            });

            // Janela de informações
            infoWindow = new google.maps.InfoWindow({
                maxWidth: 250
            });

            // Carregar dados salvos
            loadData();
            
            // Configurar eventos
            setupEventListeners();
            
            // Verificar suporte a geolocalização
            checkGeolocationSupport();
        }

        // Verificar suporte a geolocalização
        function checkGeolocationSupport() {
            if (!navigator.geolocation) {
                showToast('Seu navegador não suporta geolocalização', true);
                document.getElementById('start-trip').disabled = true;
                document.getElementById('start-trip').classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        // Função para iniciar o rastreamento GPS
        function startGPSTracking() {
            if (!navigator.geolocation) {
                showToast('Geolocalização não suportada neste navegador', true);
                return;
            }

            showToast('Iniciando rastreamento GPS...');
            
            // Atualizar estado
            isTracking = true;
            updateGPSTrackingUI(true);
            
            // Configurações do GPS
            const options = {
                enableHighAccuracy: true,
                maximumAge: 10000,
                timeout: 15000
            };

            watchId = navigator.geolocation.watchPosition(
                (position) => handlePositionSuccess(position),
                (error) => handlePositionError(error),
                options
            );
        }

        // Manipulador de sucesso na geolocalização
        function handlePositionSuccess(position) {
            const pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude
            };
            
            // Precisão em metros
            const accuracy = position.coords.accuracy;
            
            // Atualiza ou cria o marcador da posição atual
            if (!currentPositionMarker) {
                currentPositionMarker = new google.maps.Marker({
                    position: pos,
                    map: map,
                    icon: currentPositionIcon,
                    title: 'Sua posição atual',
                    zIndex: 1000,
                    optimized: false
                });
                
                // Centraliza o mapa na posição atual (apenas no primeiro movimento)
                map.setCenter(pos);
                map.setZoom(15);
            } else {
                currentPositionMarker.setPosition(pos);
            }
            
            // Adiciona a posição ao histórico do trajeto
            pathCoordinates.push(pos);
            
            // Atualiza a linha do trajeto percorrido
            updatePathPolyline();
            
            // Atualiza o status do GPS
            updateGPSStatus(true, accuracy);
        }

        // Manipulador de erro na geolocalização
        function handlePositionError(error) {
            let errorMessage;
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMessage = "Permissão de localização negada. Por favor, habilite no seu navegador.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMessage = "Informação de localização indisponível.";
                    break;
                case error.TIMEOUT:
                    errorMessage = "Tempo de espera para obter localização expirado.";
                    break;
                default:
                    errorMessage = "Erro desconhecido ao obter localização.";
            }
            
            showToast(errorMessage, true);
            stopGPSTracking();
            updateGPSStatus(false);
        }

        // Atualiza a linha do trajeto percorrido
        function updatePathPolyline() {
            if (pathPolyline) {
                pathPolyline.setMap(null);
            }
            
            if (pathCoordinates.length > 1) {
                pathPolyline = new google.maps.Polyline({
                    path: pathCoordinates,
                    geodesic: true,
                    strokeColor: '#0ea5e9',
                    strokeOpacity: 1.0,
                    strokeWeight: 4,
                    map: map,
                    zIndex: 10
                });
            }
        }

        // Atualiza a UI do rastreamento
        function updateGPSTrackingUI(isTracking) {
            const btn = document.getElementById('start-trip');
            
            if (isTracking) {
                btn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                    </svg>
                    Parar Rastreamento
                `;
                btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                btn.classList.add('bg-red-600', 'hover:bg-red-700', 'pulse-animation');
            } else {
                btn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                    </svg>
                    Iniciar Viagem
                `;
                btn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                btn.classList.remove('bg-red-600', 'hover:bg-red-700', 'pulse-animation');
            }
        }

        // Atualiza o status do GPS na UI
        function updateGPSStatus(isActive, accuracy = null) {
            const statusElement = document.getElementById('gps-status');
            const statusDot = statusElement.querySelector('span:first-child');
            
            if (isActive) {
                statusElement.classList.remove('hidden');
                statusDot.classList.remove('bg-gray-400');
                statusDot.classList.add('bg-green-500');
                
                let statusText = 'GPS Ativo';
                if (accuracy) {
                    statusText += ` (Precisão: ~${Math.round(accuracy)}m)`;
                }
                
                statusElement.querySelector('span:last-child').textContent = statusText;
            } else {
                statusElement.classList.add('hidden');
                statusDot.classList.add('bg-gray-400');
                statusDot.classList.remove('bg-green-500');
            }
        }

        // Função para parar o rastreamento GPS
        function stopGPSTracking() {
            if (watchId) {
                navigator.geolocation.clearWatch(watchId);
                watchId = null;
            }
            
            isTracking = false;
            updateGPSTrackingUI(false);
            updateGPSStatus(false);
        }

        // Carregar dados do localStorage
        function loadData() {
            try {
                const savedPlaces = localStorage.getItem('travel_places');
                const savedExpenses = localStorage.getItem('travel_expenses');
                const savedTracking = localStorage.getItem('travel_tracking');
                
                if (savedPlaces) places = JSON.parse(savedPlaces);
                if (savedExpenses) generalExpenses = JSON.parse(savedExpenses);
                
                // Restaurar rastreamento se estava ativo
                if (savedTracking === 'active') {
                    startGPSTracking();
                }
                
                renderPlaces();
                renderExpenses();
                updateRoute();
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                showToast('Erro ao carregar dados salvos', true);
            }
        }

        // Salvar dados no localStorage
        function saveData() {
            try {
                localStorage.setItem('travel_places', JSON.stringify(places));
                localStorage.setItem('travel_expenses', JSON.stringify(generalExpenses));
                localStorage.setItem('travel_tracking', isTracking ? 'active' : 'inactive');
            } catch (error) {
                console.error('Erro ao salvar dados:', error);
            }
        }

        // Renderizar lista de locais
        function renderPlaces() {
            const container = document.getElementById('places-list');
            
            // Limpar container
            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }
            
            if (places.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <p>Nenhum local adicionado ainda</p>
                        <p class="text-sm mt-1">Adicione locais para começar seu roteiro</p>
                    </div>
                `;
                return;
            }

            places.forEach((place, index) => {
                const category = categoryStyles[place.category] || categoryStyles.other;
                
                const div = document.createElement('div');
                div.className = 'place-item bg-white p-4 rounded-lg border border-gray-200';
                div.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="flex items-center gap-2">
                                <h3 class="font-semibold text-blue-800">${place.name}</h3>
                                <span class="category-badge" style="background-color: ${category.color}20; color: ${category.color}800">
                                    ${category.name}
                                </span>
                            </div>
                            ${place.value ? `<p class="text-sm text-blue-600">R$ ${place.value.toFixed(2)}</p>` : ''}
                            ${place.address ? `<p class="text-xs text-gray-500 mt-1">${place.address}</p>` : ''}
                        </div>
                        <div class="flex gap-2">
                            <button data-index="${index}" class="move-up text-blue-600 hover:text-blue-800 p-1" title="Mover para cima">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <button data-index="${index}" class="move-down text-blue-600 hover:text-blue-800 p-1" title="Mover para baixo">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <button data-index="${index}" class="delete-place text-red-500 hover:text-red-700 p-1" title="Remover local">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });

            updateStats();
        }

        // Renderizar gastos gerais
        function renderExpenses() {
            const container = document.getElementById('expenses-list');
            
            // Limpar container
            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }

            if (generalExpenses.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-3 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <p>Nenhum gasto adicionado</p>
                        <p class="text-sm mt-1">Registre seus gastos durante a viagem</p>
                    </div>
                `;
                return;
            }

            generalExpenses.forEach((expense, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center bg-gray-50 p-3 rounded-lg';
                div.innerHTML = `
                    <div>
                        <p class="font-medium">${expense.title}</p>
                        <p class="text-xs text-gray-500">${new Date(expense.date).toLocaleDateString('pt-BR')}</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <p class="font-medium">R$ ${expense.amount.toFixed(2)}</p>
                        <button data-index="${index}" class="text-red-500 hover:text-red-700" title="Remover gasto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });

            updateStats();
        }

        // Atualizar rota no mapa
        function updateRoute() {
            // Limpar marcadores antigos
            markers.forEach(marker => marker.setMap(null));
            markers = [];

            if (places.length === 0) {
                directionsRenderer.setMap(null);
                document.getElementById('route-details').innerHTML = '';
                return;
            }

            // Adicionar marcadores personalizados por categoria
            places.forEach((place, index) => {
                const category = categoryStyles[place.category] || categoryStyles.other;
                
                const marker = new google.maps.Marker({
                    position: { lat: place.lat, lng: place.lng },
                    map: map,
                    label: {
                        text: (index + 1).toString(),
                        color: 'white',
                        fontSize: '14px',
                        fontWeight: 'bold'
                    },
                    icon: {
                        url: category.icon,
                        scaledSize: new google.maps.Size(40, 40),
                        labelOrigin: new google.maps.Point(20, 13)
                    },
                    optimized: true
                });

                // InfoWindow ao clicar no marcador
                marker.addListener('click', () => {
                    infoWindow.setContent(`
                        <div class="p-3">
                            <h3 class="font-bold text-lg text-blue-800">${place.name}</h3>
                            <p class="text-sm ${category.color}-600 mb-1">${category.name}</p>
                            ${place.value ? `<p class="text-blue-600 font-medium">Custo: R$ ${place.value.toFixed(2)}</p>` : ''}
                            ${place.address ? `<p class="text-sm text-gray-600 mt-1">${place.address}</p>` : ''}
                            <p class="text-xs text-gray-500 mt-2">${new Date(place.date).toLocaleString('pt-BR')}</p>
                        </div>
                    `);
                    infoWindow.open(map, marker);
                });

                markers.push(marker);
            });

            // Se apenas um local, centralizar nele
            if (places.length === 1) {
                map.setCenter(markers[0].getPosition());
                map.setZoom(14);
                directionsRenderer.setMap(null);
                document.getElementById('route-details').innerHTML = '';
                return;
            }

            // Para múltiplos locais, calcular rota
            if (places.length >= 2) {
                const waypoints = places.slice(1, -1).map(place => ({
                    location: { lat: place.lat, lng: place.lng },
                    stopover: true
                }));

                const request = {
                    origin: { lat: places[0].lat, lng: places[0].lng },
                    destination: { lat: places[places.length - 1].lat, lng: places[places.length - 1].lng },
                    waypoints: waypoints,
                    travelMode: 'DRIVING',
                    optimizeWaypoints: true,
                    provideRouteAlternatives: false,
                    drivingOptions: {
                        departureTime: new Date(Date.now() + 1000 * 60 * 60), // 1 hora no futuro
                        trafficModel: 'bestguess'
                    }
                };

                directionsService.route(request, (result, status) => {
                    if (status === 'OK') {
                        directionsRenderer.setDirections(result);
                        
                        // Ajustar o zoom para mostrar toda a rota
                        const bounds = new google.maps.LatLngBounds();
                        result.routes[0].legs.forEach(leg => {
                            bounds.extend(leg.start_location);
                            bounds.extend(leg.end_location);
                        });
                        
                        // Não redimensionar se estiver em modo de rastreamento
                        if (!isTracking) {
                            map.fitBounds(bounds);
                        }
                        
                        updateStats(result);
                        renderRouteDetails(result);
                    } else {
                        console.error('Erro ao calcular rota:', status);
                        showToast('Erro ao calcular rota. Verifique os locais adicionados.', true);
                    }
                });
            }
        }

        // Renderizar detalhes da rota
        function renderRouteDetails(routeResult) {
            const container = document.getElementById('route-details');
            
            // Limpar container
            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }
            
            const title = document.createElement('h3');
            title.className = 'font-semibold mb-2 text-blue-800';
            title.textContent = 'Detalhes do Percurso:';
            container.appendChild(title);

            routeResult.routes[0].legs.forEach((leg, index) => {
                const fromPlace = places[index];
                const toPlace = places[index + 1];
                
                const div = document.createElement('div');
                div.className = 'bg-gray-50 p-3 rounded-lg mb-2';
                div.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="font-medium">${fromPlace.name} → ${toPlace.name}</p>
                            <p class="text-sm text-gray-600">${leg.distance.text} • ${leg.duration.text}</p>
                        </div>
                        <p class="text-blue-700 font-medium">${leg.duration.text}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Atualizar estatísticas
        function updateStats(routeResult = null) {
            // Calcular custo dos locais
            const placesCost = places.reduce((sum, place) => sum + (place.value || 0), 0);
            document.getElementById('places-cost').textContent = `R$ ${placesCost.toFixed(2)}`;
            
            // Calcular custo dos gastos gerais
            const expensesCost = generalExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            document.getElementById('expenses-cost').textContent = `R$ ${expensesCost.toFixed(2)}`;
            
            // Calcular distância e tempo totais (se tiver rota)
            let totalDistance = 0;
            let totalTime = 0;
            let fuelCost = 0;
            
            if (routeResult) {
                routeResult.routes[0].legs.forEach(leg => {
                    totalDistance += leg.distance.value;
                    totalTime += leg.duration.value;
                });
            }
            
            // Calcular custo do combustível
            const fuelEfficiency = parseFloat(document.getElementById('fuel-efficiency').value) || 10;
            const fuelPrice = parseFloat(document.getElementById('fuel-price').value) || 5.50;
            const fuelConsumption = (totalDistance / 1000) / fuelEfficiency;
            fuelCost = fuelConsumption * fuelPrice;
            
            document.getElementById('total-distance').textContent = `${(totalDistance / 1000).toFixed(1)} km`;
            
            // Converter segundos para horas e minutos
            const hours = Math.floor(totalTime / 3600);
            const minutes = Math.round((totalTime % 3600) / 60);
            let timeText = '';
            if (hours > 0) timeText += `${hours} h `;
            timeText += `${minutes} min`;
            document.getElementById('total-time').textContent = timeText;
            
            document.getElementById('fuel-cost').textContent = `R$ ${fuelCost.toFixed(2)}`;
            
            // Calcular custo total
            const totalCost = placesCost + expensesCost + fuelCost;
            document.getElementById('total-cost').textContent = `R$ ${totalCost.toFixed(2)}`;
        }

        // Exportar dados da viagem
        function exportTripData() {
            const data = {
                metadata: {
                    title: "Roteiro de Viagem",
                    date: new Date().toISOString(),
                    version: "1.0"
                },
                settings: {
                    fuelEfficiency: parseFloat(document.getElementById('fuel-efficiency').value) || 10,
                    fuelPrice: parseFloat(document.getElementById('fuel-price').value) || 5.50
                },
                places: places,
                expenses: generalExpenses,
                summary: {
                    totalDistance: document.getElementById('total-distance').textContent,
                    totalTime: document.getElementById('total-time').textContent,
                    totalCost: document.getElementById('total-cost').textContent
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `roteiro-viagem-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showToast('Roteiro exportado com sucesso!');
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Adicionar local
            document.getElementById('add-place').addEventListener('click', () => {
                const name = document.getElementById('place-name').value.trim();
                const value = parseFloat(document.getElementById('place-value').value) || 0;
                const category = document.getElementById('place-category').value;

                if (!name) {
                    showToast('Por favor, digite um nome para o local', true);
                    return;
                }

                const center = map.getCenter();
                const newPlace = {
                    name,
                    value,
                    category,
                    lat: center.lat(),
                    lng: center.lng(),
                    address: document.getElementById('search').value || '',
                    date: new Date().toISOString()
                };

                places.push(newPlace);
                saveData();
                renderPlaces();
                updateRoute();
                showToast('Local adicionado com sucesso!');

                // Limpar campos
                document.getElementById('place-name').value = '';
                document.getElementById('place-value').value = '';
                document.getElementById('search').value = '';
            });

            // Pesquisar local
            document.getElementById('btn-search').addEventListener('click', searchPlace);
            document.getElementById('search').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchPlace();
            });

            // Adicionar gasto
            document.getElementById('add-expense').addEventListener('click', () => {
                const title = document.getElementById('expense-title').value.trim();
                const amount = parseFloat(document.getElementById('expense-amount').value);

                if (!title || isNaN(amount)) {
                    showToast('Por favor, preencha todos os campos do gasto', true);
                    return;
                }

                generalExpenses.push({
                    title,
                    amount,
                    date: new Date().toISOString()
                });

                saveData();
                renderExpenses();
                showToast('Gasto adicionado com sucesso!');

                // Limpar campos
                document.getElementById('expense-title').value = '';
                document.getElementById('expense-amount').value = '';
            });

            // Interação com lista de locais
            document.getElementById('places-list').addEventListener('click', (e) => {
                const btn = e.target.closest('button');
                if (!btn) return;

                const index = parseInt(btn.dataset.index);
                if (isNaN(index)) return;

                if (btn.classList.contains('delete-place')) {
                    if (confirm('Remover este local?')) {
                        places.splice(index, 1);
                        saveData();
                        renderPlaces();
                        updateRoute();
                        showToast('Local removido!');
                    }
                } 
                else if (btn.classList.contains('move-up') && index > 0) {
                    [places[index], places[index - 1]] = [places[index - 1], places[index]];
                    saveData();
                    renderPlaces();
                    updateRoute();
                }
                else if (btn.classList.contains('move-down') && index < places.length - 1) {
                    [places[index], places[index + 1]] = [places[index + 1], places[index]];
                    saveData();
                    renderPlaces();
                    updateRoute();
                }
            });

            // Interação com lista de gastos
            document.getElementById('expenses-list').addEventListener('click', (e) => {
                const btn = e.target.closest('button');
                if (!btn) return;

                const index = parseInt(btn.dataset.index);
                if (isNaN(index)) return;

                if (confirm('Remover este gasto?')) {
                    generalExpenses.splice(index, 1);
                    saveData();
                    renderExpenses();
                    showToast('Gasto removido!');
                }
            });

            // Otimizar rota
            document.getElementById('optimize-route').addEventListener('click', () => {
                if (places.length < 2) {
                    showToast('Adicione pelo menos 2 locais para otimizar a rota', true);
                    return;
                }
                updateRoute();
                showToast('Rota otimizada com sucesso!');
            });

            // Limpar rota
            document.getElementById('clear-route').addEventListener('click', () => {
                if ((places.length > 0 || generalExpenses.length > 0 || isTracking) && 
                    confirm('Tem certeza que deseja limpar todo o roteiro? Todos os dados serão perdidos.')) {
                    places = [];
                    generalExpenses = [];
                    saveData();
                    renderPlaces();
                    renderExpenses();
                    updateRoute();
                    stopGPSTracking();
                    if (currentPositionMarker) {
                        currentPositionMarker.setMap(null);
                        currentPositionMarker = null;
                    }
                    if (pathPolyline) {
                        pathPolyline.setMap(null);
                        pathPolyline = null;
                    }
                    pathCoordinates = [];
                    showToast('Roteiro limpo com sucesso!');
                }
            });

            // Iniciar/parar viagem
            document.getElementById('start-trip').addEventListener('click', function() {
                if (isTracking) {
                    stopGPSTracking();
                    showToast('Rastreamento parado');
                } else {
                    startGPSTracking();
                }
            });

            // Atualizar cálculos quando mudar consumo ou preço do combustível
            document.getElementById('fuel-efficiency').addEventListener('change', updateStats);
            document.getElementById('fuel-price').addEventListener('change', updateStats);

            // Exportar dados
            document.getElementById('export-btn').addEventListener('click', exportTripData);

            // Ajuda
            document.getElementById('help-btn').addEventListener('click', () => {
                document.getElementById('help-modal').classList.remove('hidden');
            });

            document.getElementById('close-help').addEventListener('click', () => {
                document.getElementById('help-modal').classList.add('hidden');
            });

            // Fechar modal ao clicar fora
            document.getElementById('help-modal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('help-modal')) {
                    document.getElementById('help-modal').classList.add('hidden');
                }
            });
        }

        // Função para pesquisar local
        function searchPlace() {
            const query = document.getElementById('search').value.trim();
            if (!query) {
                showToast('Digite um local para pesquisar', true);
                return;
            }

            const request = {
                query,
                fields: ['name', 'geometry', 'formatted_address', 'types']
            };

            const service = new google.maps.places.PlacesService(map);
            service.findPlaceFromQuery(request, (results, status) => {
                if (status === 'OK' && results[0]) {
                    const place = results[0];
                    map.setCenter(place.geometry.location);
                    map.setZoom(15);
                    
                    // Preencher automaticamente o nome do local
                    document.getElementById('place-name').value = place.name;
                    
                    // Tentar determinar a categoria automaticamente
                    let category = 'other';
                    if (place.types.includes('park') || place.types.includes('natural_feature')) {
                        category = 'park';
                    } else if (place.types.includes('tourist_attraction') || place.types.includes('point_of_interest')) {
                        category = 'attraction';
                    } else if (place.types.includes('lodging') || place.types.includes('hotel')) {
                        category = 'hotel';
                    } else if (place.types.includes('restaurant') || place.types.includes('food')) {
                        category = 'restaurant';
                    } else if (place.types.includes('museum') || place.types.includes('art_gallery')) {
                        category = 'museum';
                    } else if (place.types.includes('shopping_mall') || place.types.includes('store')) {
                        category = 'shopping';
                    }
                    
                    document.getElementById('place-category').value = category;
                    
                    // Mostrar o endereço completo no campo de pesquisa
                    if (place.formatted_address) {
                        document.getElementById('search').value = place.formatted_address;
                    }
                    
                    showToast('Local encontrado! Preencha os detalhes e adicione.');
                } else {
                    showToast('Local não encontrado. Tente outro termo de busca.', true);
                }
            });
        }

// Carrega a API do Google Maps de forma assíncrona
function loadGoogleMaps() {
    const script = document.createElement('script');
    script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyAPkjcgFgdopkeZN0GnvhOc787jrajJnWc&libraries=places,directions&callback=initMap`;
    script.async = true;
    script.defer = true;
    document.head.appendChild(script);
}

// Adiciona um event listener para carregar o mapa quando a página estiver pronta
document.addEventListener('DOMContentLoaded', function() {
    // Verifica se a API do Google Maps já está carregada
    if (typeof google === 'object' && typeof google.maps === 'object') {
        initMap();
    } else {
        loadGoogleMaps();
    }
});

// Função de inicialização do mapa modificada
function initMap() {
    // Configuração inicial do mapa - centro no Brasil como fallback
    const initialLocation = { lat: -15.795, lng: -47.891 };
    
    map = new google.maps.Map(document.getElementById('map'), {
        center: initialLocation,
        zoom: 4,
        disableDefaultUI: true,
        zoomControl: true,
        fullscreenControl: true
    });

    // Restante do seu código de inicialização...
}
        
        // Inicia o aplicativo quando a página carregar
        window.addEventListener('DOMContentLoaded', loadGoogleMaps);
    </script>
</body>
</html>
